# 関数型言語としての Javascript

## なぜ Javascript なのか？

**Javascript があらゆる場所で使われているから**
Web の言語で他に類を見ない普及率を持っている。

Javascript は、オブジェクト指向かつ関数型言語でもある。

## 関数型プログラミング vs オブジェクト指向プログラミング

> [!NOTE]
> オブジェクト内のデータへアクセスする際に `this` の利用を避ける！
> メソッドスコープ以外のインスタンスへアクセスすることができるため、副作用を起こしてしまい、純粋関数ではなくなる。

**オブジェクト指向プログラミング（OOP）**では、データとそれに関連する処理をオブジェクトにカプセル化します。
このアプローチの利点は、データと操作を一つのユニットとして扱うことができる点です。
しかし、この方法では、同じ処理を異なるオブジェクトで実行したい場合、それぞれのオブジェクトに対して同じ処理を再実装する必要があることがあります。
これにより、コードの重複が発生し、保守性が低下する可能性があります。

例えば、Male と Female という2つのオブジェクトがあり、これらに共通する処理として walk メソッドがあるとします。
オブジェクト指向では、これらのオブジェクトのスーパークラス（例えば Human）を作成し、共通の walk メソッドをそのスーパークラスに定義します。
このように、オブジェクト指向プログラミングでは、継承を利用して処理を抽象化し、コードの再利用を促進します。

一方、**関数型プログラミング（FP）**では、データと処理を分離し、処理を関数として表現します。
例えば、walk という関数を作成し、Human、Dog、Cat など、歩行可能なあらゆるオブジェクトに対して再利用できるようにします。
関数型プログラミングでは、引数の型を一般化し、再利用性の高いコードを実現します。
ここで言う「Human みたいな引数」とは、walk 関数が人間以外の動物にも適用可能であることを意味しています。
つまり、関数型プログラミングでは、より汎用的な関数を定義することで抽象化を行います。

プログラミングにおいては、コードの重複を減らし、再利用可能で保守性の高いコードを作成することが重要です。
そのため、処理の抽象化が必要であり、この抽象化の方法がオブジェクト指向と関数型プログラミングで異なります。

## Javascript オブジェクトの状態管理

Javascript はオブジェクトのプロパティは動的で追加・削除・変更が可能です。
たとえクラスのインスタンス変数がプライベートであっても、外部からアクセスし、変更できてしまいます。
この仕様は、状態管理を行う上で最悪と言えます。

> [!NOTE]
> ES2022 からは、`#` を使ってプライベートフィールドを定義できるようになっている。
> 公式 https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Classes/Private_properties

## オブジェクトを値として扱う

**関数型プログラミングにおける値とは、数値や文字列のようなプリミティブなデータ型で本質的に不変であるものを指します。**
Javascript における動的なデータ構造を持つ、オブジェクトを値のように扱うことで、堅牢な状態管理を可能にする。

> [!NOTE] 前提として、Javascript のクラスによって作られるオブジェクトは、値として扱えない。
> 外から直接インスタンス変数を書き換えることができるため

### クロージャーを使う

クロージャーは、関数とその関数が作られた環境（スコープ）を持つオブジェクトです。

```javascript
const createPerson = (name, age) => {
    let _name = name;
    let _age = age;

    return {
        getName: () => _name,
        getAge: () => _age,
        setName: (name) => _name = name,
        setAge: (age) => _age = age
    };
}
```

